# my_DBNet

## Датасет
Есть готовый объект torch датасета ICDAR2015Dataset, заточенный под датасет ICDAR2015. Сейчас загрузка работает крайне неудобно:  
Нужно создать файлы train.txt и text.txt, в которых содержатся такие строчки: 
`/test/img/001.jpg  /test/gt/001.txt` - разделены табуляцией. Соответственно, картинка и информация о том, где находится текст. Файл `001.txt` выглядит примерно так: `x1, y1, x2, y2, x3, y3, x4, y4, annotation`. Здесь, вообще говоря, может быть и больше четырёх точек, текст может быть заключён не только в прямоугольник, но и в какой-то произвольный многоугольник, но нужно будет несколько изменить код датасета.  

Можно, в принципе, переделать датасет.    
Там внутри датасета из текстовых коробок объектами MakeSrinkMap и MakeBorderMap, соответственно, создаются бинарные и пороговые карты и маски коробок. В саму модель должны, по итогу, заходить словари с ключами `img, srink_map, shrink_mask, border_map, border_mask`. Небольшое пояснение: mask карты - это маскировочные карты при обучении на соответвующих map, то есть можно выбрать, что игнорировать, а что - нет.

## Модель  
Пример тренировки датасета приведён в тетрадке `DBNet.ipynb`   
Пример обработки изображения моделью приведён в тетрадке `DBNet_test.ipynb`  
Ещё возможно потестировать более тяжёлые версии резнета, такие как `resnet34, resnet50`, просто замени `resnet18` при создании модели. Пока я добавил только самые дешёвые резнеты, в будущем можно будет протестировать какой-нибудь другой бекбон.
